✅ helpy-pro initialized
✅ gpt-oss-20b initialized
✅ gpt-5.2 initialized

==================================================
KMMLU 재평가 시작
==================================================

[KMMLU] Criminal-Law
Evaluating helpy-pro on kmmlu_Criminal-Law (100 samples)...
  0%|          | 0/100 [00:00<?, ?it/s]  0%|          | 0/100 [00:08<?, ?it/s]
Traceback (most recent call last):
  File "/Users/rainyforest/Desktop/SDIJ_FSRT/2026w-benchmark/rerun_failed.py", line 158, in <module>
    run_failed_evaluations()
    ~~~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/rainyforest/Desktop/SDIJ_FSRT/2026w-benchmark/rerun_failed.py", line 105, in run_failed_evaluations
    results = evaluate_task(model, f"kmmlu_{cat}", ds, prompts.format_kmmlu)
  File "/Users/rainyforest/Desktop/SDIJ_FSRT/2026w-benchmark/rerun_failed.py", line 58, in evaluate_task
    prediction = model.generate(prompt)
  File "/Users/rainyforest/Desktop/SDIJ_FSRT/2026w-benchmark/src/models/helpy.py", line 38, in generate
    response = requests.post(self.api_url, headers=headers, json=payload, timeout=600)
  File "/Users/rainyforest/Desktop/SDIJ_FSRT/2026w-benchmark/venv/lib/python3.14/site-packages/requests/api.py", line 115, in post
    return request("post", url, data=data, json=json, **kwargs)
  File "/Users/rainyforest/Desktop/SDIJ_FSRT/2026w-benchmark/venv/lib/python3.14/site-packages/requests/api.py", line 59, in request
    return session.request(method=method, url=url, **kwargs)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/rainyforest/Desktop/SDIJ_FSRT/2026w-benchmark/venv/lib/python3.14/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/Users/rainyforest/Desktop/SDIJ_FSRT/2026w-benchmark/venv/lib/python3.14/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/Users/rainyforest/Desktop/SDIJ_FSRT/2026w-benchmark/venv/lib/python3.14/site-packages/requests/adapters.py", line 644, in send
    resp = conn.urlopen(
        method=request.method,
    ...<9 lines>...
        chunked=chunked,
    )
  File "/Users/rainyforest/Desktop/SDIJ_FSRT/2026w-benchmark/venv/lib/python3.14/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
        conn,
    ...<10 lines>...
        **response_kw,
    )
  File "/Users/rainyforest/Desktop/SDIJ_FSRT/2026w-benchmark/venv/lib/python3.14/site-packages/urllib3/connectionpool.py", line 534, in _make_request
    response = conn.getresponse()
  File "/Users/rainyforest/Desktop/SDIJ_FSRT/2026w-benchmark/venv/lib/python3.14/site-packages/urllib3/connection.py", line 571, in getresponse
    httplib_response = super().getresponse()
  File "/opt/homebrew/Cellar/python@3.14/3.14.2/Frameworks/Python.framework/Versions/3.14/lib/python3.14/http/client.py", line 1450, in getresponse
    response.begin()
    ~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.14/3.14.2/Frameworks/Python.framework/Versions/3.14/lib/python3.14/http/client.py", line 336, in begin
    version, status, reason = self._read_status()
                              ~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.14/3.14.2/Frameworks/Python.framework/Versions/3.14/lib/python3.14/http/client.py", line 297, in _read_status
    line = str(self.fp.readline(_MAXLINE + 1), "iso-8859-1")
               ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.14/3.14.2/Frameworks/Python.framework/Versions/3.14/lib/python3.14/socket.py", line 725, in readinto
    return self._sock.recv_into(b)
           ~~~~~~~~~~~~~~~~~~~~^^^
  File "/opt/homebrew/Cellar/python@3.14/3.14.2/Frameworks/Python.framework/Versions/3.14/lib/python3.14/ssl.py", line 1304, in recv_into
    return self.read(nbytes, buffer)
           ~~~~~~~~~^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.14/3.14.2/Frameworks/Python.framework/Versions/3.14/lib/python3.14/ssl.py", line 1138, in read
    return self._sslobj.read(len, buffer)
           ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
KeyboardInterrupt
✅ helpy-pro initialized
✅ gpt-oss-20b initialized
✅ gpt-5.2 initialized

==================================================
KMMLU 재평가 시작
==================================================

[KMMLU] Criminal-Law
Traceback (most recent call last):
  File "/Users/rainyforest/Desktop/SDIJ_FSRT/2026w-benchmark/rerun_failed.py", line 158, in <module>
    run_failed_evaluations()
    ~~~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/rainyforest/Desktop/SDIJ_FSRT/2026w-benchmark/rerun_failed.py", line 103, in run_failed_evaluations
    ds = load_kmmlu(cat, config.SAMPLE_SIZE)['test']
         ~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/rainyforest/Desktop/SDIJ_FSRT/2026w-benchmark/src/benchmarks/kmmlu.py", line 28, in load_kmmlu
    ds = load_dataset("HAERAE-HUB/KMMLU", category)
  File "/Users/rainyforest/Desktop/SDIJ_FSRT/2026w-benchmark/venv/lib/python3.14/site-packages/datasets/load.py", line 1488, in load_dataset
    builder_instance = load_dataset_builder(
        path=path,
    ...<10 lines>...
        **config_kwargs,
    )
  File "/Users/rainyforest/Desktop/SDIJ_FSRT/2026w-benchmark/venv/lib/python3.14/site-packages/datasets/load.py", line 1133, in load_dataset_builder
    dataset_module = dataset_module_factory(
        path,
    ...<5 lines>...
        cache_dir=cache_dir,
    )
  File "/Users/rainyforest/Desktop/SDIJ_FSRT/2026w-benchmark/venv/lib/python3.14/site-packages/datasets/load.py", line 1007, in dataset_module_factory
    ).get_module()
      ~~~~~~~~~~^^
  File "/Users/rainyforest/Desktop/SDIJ_FSRT/2026w-benchmark/venv/lib/python3.14/site-packages/datasets/load.py", line 593, in get_module
    standalone_yaml_path = cached_path(
        hf_dataset_url(self.name, config.REPOYAML_FILENAME, revision=self.commit_hash),
        download_config=download_config,
    )
  File "/Users/rainyforest/Desktop/SDIJ_FSRT/2026w-benchmark/venv/lib/python3.14/site-packages/datasets/utils/file_utils.py", line 188, in cached_path
    ).hf_hub_download(
      ~~~~~~~~~~~~~~~^
        repo_id=resolved_path.repo_id,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<4 lines>...
        proxies=download_config.proxies,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/rainyforest/Desktop/SDIJ_FSRT/2026w-benchmark/venv/lib/python3.14/site-packages/huggingface_hub/utils/_validators.py", line 89, in _inner_fn
    return fn(*args, **kwargs)
  File "/Users/rainyforest/Desktop/SDIJ_FSRT/2026w-benchmark/venv/lib/python3.14/site-packages/huggingface_hub/hf_api.py", line 5581, in hf_hub_download
    return hf_hub_download(
        repo_id=repo_id,
    ...<16 lines>...
        dry_run=dry_run,
    )
  File "/Users/rainyforest/Desktop/SDIJ_FSRT/2026w-benchmark/venv/lib/python3.14/site-packages/huggingface_hub/utils/_validators.py", line 89, in _inner_fn
    return fn(*args, **kwargs)
  File "/Users/rainyforest/Desktop/SDIJ_FSRT/2026w-benchmark/venv/lib/python3.14/site-packages/huggingface_hub/file_download.py", line 1024, in hf_hub_download
    return _hf_hub_download_to_cache_dir(
        # Destination
    ...<15 lines>...
        dry_run=dry_run,
    )
  File "/Users/rainyforest/Desktop/SDIJ_FSRT/2026w-benchmark/venv/lib/python3.14/site-packages/huggingface_hub/file_download.py", line 1099, in _hf_hub_download_to_cache_dir
    (url_to_download, etag, commit_hash, expected_size, xet_file_data, head_call_error) = _get_metadata_or_catch_error(
                                                                                          ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        repo_id=repo_id,
        ^^^^^^^^^^^^^^^^
    ...<9 lines>...
        relative_filename=relative_filename,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/rainyforest/Desktop/SDIJ_FSRT/2026w-benchmark/venv/lib/python3.14/site-packages/huggingface_hub/file_download.py", line 1691, in _get_metadata_or_catch_error
    metadata = get_hf_file_metadata(
        url=url,
    ...<4 lines>...
        retry_on_errors=retry_on_errors,
    )
  File "/Users/rainyforest/Desktop/SDIJ_FSRT/2026w-benchmark/venv/lib/python3.14/site-packages/huggingface_hub/utils/_validators.py", line 89, in _inner_fn
    return fn(*args, **kwargs)
  File "/Users/rainyforest/Desktop/SDIJ_FSRT/2026w-benchmark/venv/lib/python3.14/site-packages/huggingface_hub/file_download.py", line 1614, in get_hf_file_metadata
    response = _httpx_follow_relative_redirects(
        method="HEAD", url=url, headers=hf_headers, timeout=timeout, retry_on_errors=retry_on_errors
    )
  File "/Users/rainyforest/Desktop/SDIJ_FSRT/2026w-benchmark/venv/lib/python3.14/site-packages/huggingface_hub/file_download.py", line 302, in _httpx_follow_relative_redirects
    response = http_backoff(
        method=method,
    ...<3 lines>...
        **no_retry_kwargs,
    )
  File "/Users/rainyforest/Desktop/SDIJ_FSRT/2026w-benchmark/venv/lib/python3.14/site-packages/huggingface_hub/utils/_http.py", line 506, in http_backoff
    return next(
        _http_backoff_base(
    ...<9 lines>...
        )
    )
  File "/Users/rainyforest/Desktop/SDIJ_FSRT/2026w-benchmark/venv/lib/python3.14/site-packages/huggingface_hub/utils/_http.py", line 414, in _http_backoff_base
    response = client.request(method=method, url=url, **kwargs)
  File "/Users/rainyforest/Desktop/SDIJ_FSRT/2026w-benchmark/venv/lib/python3.14/site-packages/httpx/_client.py", line 825, in request
    return self.send(request, auth=auth, follow_redirects=follow_redirects)
           ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/rainyforest/Desktop/SDIJ_FSRT/2026w-benchmark/venv/lib/python3.14/site-packages/httpx/_client.py", line 914, in send
    response = self._send_handling_auth(
        request,
    ...<2 lines>...
        history=[],
    )
  File "/Users/rainyforest/Desktop/SDIJ_FSRT/2026w-benchmark/venv/lib/python3.14/site-packages/httpx/_client.py", line 942, in _send_handling_auth
    response = self._send_handling_redirects(
        request,
        follow_redirects=follow_redirects,
        history=history,
    )
  File "/Users/rainyforest/Desktop/SDIJ_FSRT/2026w-benchmark/venv/lib/python3.14/site-packages/httpx/_client.py", line 979, in _send_handling_redirects
    response = self._send_single_request(request)
  File "/Users/rainyforest/Desktop/SDIJ_FSRT/2026w-benchmark/venv/lib/python3.14/site-packages/httpx/_client.py", line 1014, in _send_single_request
    response = transport.handle_request(request)
  File "/Users/rainyforest/Desktop/SDIJ_FSRT/2026w-benchmark/venv/lib/python3.14/site-packages/httpx/_transports/default.py", line 250, in handle_request
    resp = self._pool.handle_request(req)
  File "/Users/rainyforest/Desktop/SDIJ_FSRT/2026w-benchmark/venv/lib/python3.14/site-packages/httpcore/_sync/connection_pool.py", line 256, in handle_request
    raise exc from None
  File "/Users/rainyforest/Desktop/SDIJ_FSRT/2026w-benchmark/venv/lib/python3.14/site-packages/httpcore/_sync/connection_pool.py", line 236, in handle_request
    response = connection.handle_request(
        pool_request.request
    )
  File "/Users/rainyforest/Desktop/SDIJ_FSRT/2026w-benchmark/venv/lib/python3.14/site-packages/httpcore/_sync/connection.py", line 103, in handle_request
    return self._connection.handle_request(request)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^
  File "/Users/rainyforest/Desktop/SDIJ_FSRT/2026w-benchmark/venv/lib/python3.14/site-packages/httpcore/_sync/http11.py", line 136, in handle_request
    raise exc
  File "/Users/rainyforest/Desktop/SDIJ_FSRT/2026w-benchmark/venv/lib/python3.14/site-packages/httpcore/_sync/http11.py", line 106, in handle_request
    ) = self._receive_response_headers(**kwargs)
        ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/rainyforest/Desktop/SDIJ_FSRT/2026w-benchmark/venv/lib/python3.14/site-packages/httpcore/_sync/http11.py", line 177, in _receive_response_headers
    event = self._receive_event(timeout=timeout)
  File "/Users/rainyforest/Desktop/SDIJ_FSRT/2026w-benchmark/venv/lib/python3.14/site-packages/httpcore/_sync/http11.py", line 217, in _receive_event
    data = self._network_stream.read(
        self.READ_NUM_BYTES, timeout=timeout
    )
  File "/Users/rainyforest/Desktop/SDIJ_FSRT/2026w-benchmark/venv/lib/python3.14/site-packages/httpcore/_backends/sync.py", line 128, in read
    return self._sock.recv(max_bytes)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.14/3.14.2/Frameworks/Python.framework/Versions/3.14/lib/python3.14/ssl.py", line 1285, in recv
    return self.read(buflen)
           ~~~~~~~~~^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.14/3.14.2/Frameworks/Python.framework/Versions/3.14/lib/python3.14/ssl.py", line 1140, in read
    return self._sslobj.read(len)
           ~~~~~~~~~~~~~~~~~^^^^^
KeyboardInterrupt
